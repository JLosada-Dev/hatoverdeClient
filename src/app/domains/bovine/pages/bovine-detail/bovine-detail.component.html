<!-- bovine-detail.component.html -->
<section class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-12">
  <!-- 1) Información general (mejorado Tailwind) -->
  <div
    class="relative grid grid-cols-1 md:grid-cols-3 gap-10 md:items-center bg-white/70 rounded-2xl shadow-lg p-6 md:p-8 border border-gray-100"
  >
    <!-- Imagen -->
    <div class="flex justify-center md:justify-start">
      <img
        src="img/bovine-placeholder.jpg"
        alt="Foto del bovino"
        class="w-44 h-44 sm:w-52 sm:h-52 object-cover rounded-2xl shadow-lg border-2 border-green-100"
      />
    </div>
    <!-- Datos -->
    <div class="md:col-span-2 space-y-3">
      <h2 class="text-xs font-bold text-green-600 uppercase tracking-widest">
        {{ bovine()?.breed }}
      </h2>
      <div class="flex items-baseline justify-between">
        <h1
          class="text-3xl sm:text-4xl font-black text-gray-900 tracking-tight"
        >
          {{ bovine()?.ear_tag }}
        </h1>
        <!-- Botón editar bovino -->
        <button
          type="button"
          aria-label="Modificar bovino"
          class="flex items-center gap-1 px-3 py-1.5 bg-green-50/70 border border-green-200 text-green-700 rounded-lg shadow hover:bg-green-100 hover:border-green-300 hover:text-green-800 focus:outline-none focus:ring-2 focus:ring-green-300 transition duration-150 hover:cursor-pointer"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-4 w-4"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="1.5"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M16.862 4.487l2.651 2.651M7.5 13.5l6-6m0 0l2.646 2.646M7.5 13.5L4 20h6.5z"
            />
          </svg>
          <span class="text-sm font-semibold">Editar</span>
        </button>
      </div>
      <ul class="space-y-1 text-gray-700 text-base">
        <li>
          <span class="font-semibold">Peso:</span> {{ bovine()?.weight_kg }} kg
        </li>
        <li>
          <span class="font-semibold">Sexo:</span>
          {{ bovine()?.sex === "Male" ? "Macho" : "Hembra" }}
        </li>
        <li>
          <span class="font-semibold">Nacido:</span>
          {{ bovine()?.date_of_birth | date: "longDate" }}
        </li>
        <li>
          <span class="font-semibold">Lactancia:</span>
          {{
            bovine()?.sex === "Female"
              ? "Etapa " + bovine()?.lactation_stage
              : "—"
          }}
        </li>
        <li>
          <span
            class="inline-block px-3 py-0.5 rounded-full text-sm font-bold bg-green-200 text-green-800 shadow-sm"
          >
            Activo
          </span>
        </li>
      </ul>
    </div>
  </div>

  <!-- 2) Producción diaria (solo hembras) -->
  <div *ngIf="bovine()?.sex === 'Female'" class="space-y-4">
    <!-- Header -->
    <div class="flex items-center justify-between">
      <h3 class="text-xl font-semibold text-gray-800">Producción Diaria</h3>
      <button
        type="button"
        (click)="onAddProduction()"
        class="px-4 py-2 text-sm font-semibold text-white bg-green-600 rounded-lg shadow hover:bg-green-500 focus:ring-2 focus:ring-green-400 transition-all duration-200"
      >
        + Producción
      </button>
    </div>

    <!-- Tabla -->
    <div
      class="overflow-x-auto rounded-2xl shadow-lg border border-gray-100 bg-white/70"
    >
      <table class="min-w-full table-auto divide-y divide-gray-200">
        <thead class="bg-gray-100">
          <tr>
            <th
              class="px-6 py-3 text-left text-xs font-bold text-gray-700 tracking-wider"
            >
              Hora
            </th>
            <th
              class="px-6 py-3 text-left text-xs font-bold text-gray-700 tracking-wider"
            >
              Litros
            </th>
            <th
              class="px-6 py-3 text-left text-xs font-bold text-gray-700 tracking-wider"
            >
              Grasa (%)
            </th>
            <th
              class="px-6 py-3 text-left text-xs font-bold text-gray-700 tracking-wider"
            >
              Proteína (%)
            </th>
            <th
              class="w-20 px-6 py-3 text-center text-xs font-bold text-gray-700 tracking-wider"
            >
              Acción
            </th>
          </tr>
        </thead>
        <tbody class="bg-white/80 divide-y divide-gray-200">
          <tr
            *ngFor="let prod of paginatedProductions()"
            class="hover:bg-green-50/60 transition"
          >
            <td class="px-6 py-4 text-green-800 font-medium">
              {{ prod.milking_time | date: "shortTime" }}
            </td>
            <td class="px-6 py-4 text-gray-700">{{ prod.milk_yield }}</td>
            <td class="px-6 py-4 text-gray-700">{{ prod.milk_fat ?? "–" }}</td>
            <td class="px-6 py-4 text-gray-700">
              {{ prod.milk_protein ?? "–" }}
            </td>
            <td class="px-6 py-4 text-center">
              <button
                type="button"
                (click)="onEditProduction(prod)"
                class="inline-flex items-center gap-1 px-3 py-1 bg-green-50/70 border border-green-200 text-green-700 rounded-lg shadow hover:bg-green-100 hover:border-green-300 hover:text-green-800 focus:outline-none focus:ring-2 focus:ring-green-300 transition text-sm font-semibold"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-4 w-4"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M16.862 4.487l2.651 2.651M7.5 13.5l6-6m0 0l2.646 2.646M7.5 13.5L4 20h6.5z"
                  />
                </svg>
                Editar
              </button>
            </td>
          </tr>
          <tr *ngIf="!productions().length">
            <td colspan="5" class="px-6 py-4 text-center text-gray-500">
              No hay registros de producción.
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Paginación -->
    <div class="flex items-center justify-between mt-4 text-sm text-gray-700">
      <button
        (click)="prevPage()"
        [disabled]="pageIndex() === 0"
        class="px-3 py-1 rounded-lg border border-gray-300 bg-white/70 hover:bg-green-50/70 disabled:opacity-50 transition font-semibold text-green-700"
      >
        ← Anterior
      </button>

      <span class="font-semibold text-gray-800">
        Página {{ pageIndex() + 1 }} de {{ totalPages() }}
      </span>

      <button
        (click)="nextPage()"
        [disabled]="pageIndex() + 1 >= totalPages()"
        class="px-3 py-1 rounded-lg border border-gray-300 bg-white/70 hover:bg-green-50/70 disabled:opacity-50 transition font-semibold text-green-700"
      >
        Siguiente →
      </button>
    </div>
  </div>

  <!-- 3) Eventos registrados (mejorado) -->
  <div class="space-y-4">
    <!-- Header con título y botón Agregar -->
    <div class="flex items-center justify-between">
      <h3 class="text-xl font-semibold text-gray-800">Eventos Registrados</h3>
      <button
        (click)="onAddEvent()"
        type="button"
        class="px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-500 focus:ring-2 focus:ring-green-400 transition-all duration-200 shadow-sm"
      >
        + Registro
      </button>
    </div>

    <!-- Contenedor de eventos -->
    <div
      class="bg-white rounded-lg shadow divide-y divide-gray-200 overflow-hidden"
    >
      <!-- Item de evento -->
      <div
        *ngFor="let ev of eventBovine()"
        class="flex flex-col sm:flex-row sm:items-center justify-between p-4 hover:bg-gray-50 transition"
      >
        <!-- Detalles -->
        <div
          class="flex-1 grid grid-cols-1 sm:grid-cols-2 gap-2 text-sm text-gray-700"
        >
          <div>
            <span class="font-medium">Categoría:</span> {{ ev.event_category }}
          </div>
          <div>
            <span class="font-medium">Fecha:</span>
            {{ ev.event_date | date: "short" }}
          </div>
          <div><span class="font-medium">Tipo:</span> {{ ev.event_type }}</div>
          <div>
            <span class="font-medium">Severidad:</span>
            {{ ev.severity ?? "–" }}
          </div>
          <div class="sm:col-span-2">
            <span class="font-medium">Notas:</span> {{ ev.notes ?? "–" }}
          </div>
        </div>
        <!-- Botón Editar -->
        <button
          type="button"
          (click)="onEditEvent(ev)"
          class="inline-flex items-center gap-1 px-3 py-1 bg-green-50/70 border border-green-200 text-green-700 rounded-lg shadow hover:bg-green-100 hover:border-green-300 hover:text-green-800 focus:outline-none focus:ring-2 focus:ring-green-300 transition text-sm font-semibold"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-4 w-4"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="1.5"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M16.862 4.487l2.651 2.651M7.5 13.5l6-6m0 0l2.646 2.646M7.5 13.5L4 20h6.5z"
            />
          </svg>
          Editar
        </button>
      </div>

      <!-- Fallback cuando no hay eventos -->
      <div *ngIf="!eventBovine()?.length" class="p-4 text-center text-gray-500">
        No hay eventos registrados.
      </div>
    </div>
  </div>
</section>
